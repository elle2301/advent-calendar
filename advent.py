import streamlit as stimport jsonimport osimport datetimest.set_page_config(page_title="Advent Calendar 2025", layout="wide")# ========== CONFIG ==========SAVE_FILE = "doors.json"TEST_DATE = None  # for testing: TEST_DATE = datetime.date(2025, 12, 3)# ========== DATE LOGIC ==========def get_today():    if TEST_DATE:        return TEST_DATE    return datetime.date.today()today = get_today()current_day = today.day if today.month == 12 else 0# ========== JSON LOAD / SAVE ==========def load_doors():    if os.path.exists(SAVE_FILE):        with open(SAVE_FILE, "r") as f:            return set(json.load(f))    return set()def save_doors(open_doors):    with open(SAVE_FILE, "w") as f:        json.dump(list(open_doors), f)open_doors = load_doors()if "open_doors" not in st.session_state:    st.session_state.open_doors = open_doors# ========== CHRISTMAS STYLE WITH SNOW ==========st.markdown("""<style>body {    background: linear-gradient(to bottom, #fff8f0, #f7e1d7);    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}/* Compact readable content box */.open-box {    background-color: #fff8e6;    border: 2px solid #e4c26a;    padding: 16px 18px;    border-radius: 12px;    margin-top: 10px;    font-size: 15px;    line-height: 1.45;    color: #333;    max-width: 380px;    /* âœ¨ Soft golden glow */    box-shadow:        0 0 6px rgba(228, 194, 106, 0.6),        0 0 15px rgba(228, 194, 106, 0.4),        0 0 25px rgba(228, 194, 106, 0.25);        /* Optional: subtle animation */    animation: glowpulse 2.4s ease-in-out infinite alternate;}/* âœ¨ Gentle breathing glow animation */@keyframes glowpulse {    from {        box-shadow:            0 0 5px rgba(228, 194, 106, 0.4),            0 0 12px rgba(228, 194, 106, 0.3),            0 0 18px rgba(228, 194, 106, 0.15);    }    to {        box-shadow:            0 0 8px rgba(228, 194, 106, 0.7),            0 0 20px rgba(228, 194, 106, 0.45),            0 0 35px rgba(228, 194, 106, 0.25);    }}/* Door button */div.stButton > button {    background-color: #d62828 !important;    color: white !important;    font-size: 20px !important;    font-weight: bold !important;    border-radius: 12px !important;    padding: 20px !important;    width: 100% !important;    height: 100px !important;    box-shadow: 0 5px 10px rgba(0,0,0,0.2) !important;    transition: all 0.2s !important;}div.stButton > button:hover {    background-color: #f77f00 !important;    transform: translateY(-3px) scale(1.05);    cursor: pointer;}/* Snow animation */@keyframes snow {    0% { transform: translateY(-10px); }    100% { transform: translateY(100vh); }}.snowflake {    position: fixed;    top: -10px;    font-size: 24px;    color: #ffffff80;    user-select: none;    pointer-events: none;    animation: snow linear infinite;}.snowflake:nth-child(1) { left: 5vw; animation-duration: 8s; }.snowflake:nth-child(2) { left: 20vw; animation-duration: 12s; }.snowflake:nth-child(3) { left: 50vw; animation-duration: 9s; }.snowflake:nth-child(4) { left: 70vw; animation-duration: 11s; }.snowflake:nth-child(5) { left: 85vw; animation-duration: 10s; }</style><div class="snowflake">â„</div><div class="snowflake">â„</div><div class="snowflake">â„</div><div class="snowflake">â„</div><div class="snowflake">â„</div>""", unsafe_allow_html=True)# ========== HEADER ==========st.markdown(f"""<h1 style='text-align:center; color:#d62828; font-size: 60px;'>ğŸ„ Advent Calendar 2025 ğŸ„</h1><p style='text-align:center; font-size: 22px; color:#444;'>Open one door each day in December!<br>Today is: <b>{today.strftime('%B %d, %Y')}</b></p>""", unsafe_allow_html=True)# ========== EMOJIS ONLY FOR CLOSED DOORS ==========emojis = {    1: "ğŸ", 2: "ğŸª", 3: "â˜ƒï¸", 4: "ğŸ„", 5: "ğŸ•¯ï¸", 6: "ğŸ«",    7: "â„ï¸", 8: "ğŸ§¦", 9: "ğŸ¶", 10: "ğŸ¦Œ", 11: "ğŸŒŸ", 12: "ğŸ›·",    13: "ğŸ­", 14: "ğŸ¥›", 15: "ğŸ›ï¸", 16: "ğŸ‰", 17: "ğŸ§¸", 18: "ğŸ",    19: "ğŸ¥¨", 20: "ğŸ•Šï¸", 21: "ğŸ…", 22: "ğŸ§‘â€ğŸ„", 23: "ğŸ””", 24: "âœ¨"}# ========== DOOR TEXT (EXACTLY AS YOU PROVIDED) ==========door_content = {    1: """<h3>Rudolph is missing!</h3>On December 1st, Michael Rabes appears panicked in the Fixed Network Performance Teamâ€™s video conference. â€œRudolph is gone!â€ he calls out. â€œHis GPS horn isnâ€™t sending any signal!â€ We need a search team immediately.<br><br>Davide immediately contacts his former colleagues from Mobile Benchmarking and asks for an initial IP-trace analysis â€“ unsuccessfully. The team decides to start the search simultaneously in all countries.<br><br><h4>Puzzle 1</h4>What kind of animal is Rudolph? Write down the first letter of that animal.    """,    2: """<h3>A first clue from Spain</h3>Susana and Marta first scan the GCP for traces to find the last signal from the Rudolph tracker. According to the IP, the signal ends in northeastern Spain. â€œMaybe he's at the Cabalgata preparations,â€ Marta suspects.<br><br><h4>Puzzle 2</h4>In which region of Spain did the signal end? The first letter of the region is required.    """,    3: """<h3>Barcelona at Night</h3>In nighttime Barcelona, Carlos sets up a Teams conference and reports to Madrid that a red light was seen above the Sagrada FamÃ­lia. But suddenly Manuel dials into the call and points out thatâ€¦<br><br><h4>Puzzle 3</h4>What color is Rudolphâ€™s nose? We are looking for the first letter.    """,    4: """<h3>Off to Italy</h3>â€¦ the signal suddenly jumped to Italy. They immediately call Sonia and Silvia. They search for unusual activity and find an oddity! With a deviation of 3.9m vertically, they stumble uponâ€¦<br><br><h4>Puzzle 4</h4>â€¦a landmark in Italy with a vertical deviation of 3.9m? The first letter of the city where it is located is required.    """,    5: """<h3>The Witch Befana</h3>Meanwhile, Massimo pursues an entirely different idea and reminds the team of the Italian tradition of the â€œBefana,â€ who brings gifts on January 6th. But surely a witch didnâ€™t kidnap Rudolphâ€¦ or did she? Just to be safe, he creates a year-over-year comparison analysis.<br><br><h4>Puzzle 5</h4>What is the third letter of the abbreviation for a year-over-year comparison?    """,    6: """<h3>Romanian Trace</h3>An LTE cell handover suddenly leads to Romania. Carmen and Lucian discover a hoofprint in snowy Cluj.<br><br><h4>Puzzle 6</h4>What is a typical festive cake served at Easter and Christmas in Romania? Write down the fourth letter.    """,    7: """<h3>Traditions in Transylvania</h3>While Jana investigates local customs with the team, they hear of a â€œred star in the sky.â€ Was it Rudolph?<br><br><h4>Puzzle 7</h4>Which letter corresponds to the 8th letter of the alphabet?    """,    8: """<h3>The Code in the Snow</h3>Manuel discovers a pattern in the snow â€“ like a binary code. â€œMaybe Rudolph tried to communicate!â€<br><br><h4>Puzzle 8</h4>Which letter corresponds to ASCII code 69?    """,    9: """<h3>Shift to Germany</h3>An FWA sensor in the Black Forest detects a strong heat source â€“ could be Rudolphâ€™s nose, Michael thinks.<br><br><h4>Puzzle 9</h4>A typical hot German drink served at Christmas markets that can cause a red nose? Write down the second letter of the second word.    """,    10: """<h3>Technical Breakthrough</h3>Paco and Jose Luis reconstruct a voice packet from Rudolphâ€™s tracker. It contains only one word: â€œNordpolâ€ (North Pole).<br><br><h4>Puzzle 10</h4>What is the name of a special type of table in Excel? Take the first letter.    """,    11: """<h3>Czech Republic Calling</h3>A mobile operator reports a strange red light reflection near Brno. Miroslav heads off immediately.<br><br><h4>Puzzle 11</h4>The first letter of a Czech Christmas tradition is needed.    """,    12: """<h3>The Golem of Prague</h3>His path leads into an old town said to be protected by a Golem. Has he perhaps tracked Rudolph?<br><br><h4>Puzzle 12</h4>Where did Miroslav go? Write down the first letter of the city.    """,    13: """<h3>The whole team now meets online.</h3>Miguel analyzes all signals and movement patterns: â€œRudolph moves cyclically â€“ as if someone is letting him fly!â€<br><br><h4>Puzzle 13</h4>How do you write â€œSchlittenâ€ in English? Remember the first letter.    """,    14: """<h3>Christmas Magic in Madrid</h3>While Javier continues interpreting the data, new traces appear in Madrid â€“ at a light show with 3D projections.<br><br><h4>Puzzle 14</h4>Which cavity is traditionally filled with gifts and sweets until December 24/25 in Aragon? Write down the first letter of the second word.    """,    15: """<h3>Hologram or Reality?</h3>Michelle realizes that some sightings were only projections â€“ but one signal is real.<br><br><h4>Puzzle 15</h4>When spotting which â€œstarâ€ may people in many countries make a wish? Write down the tenth letter of the German word.    """,    16: """<h3>The IP Address</h3>A ping returns a strange result: 24.12.25.12 â€“ Santa?<br><br><h4>Puzzle 16</h4>What does the abbreviation â€œIPâ€ stand for? The fifth letter is required.    """,    17: """<h3>The Northern Route</h3>A final peak in Netperform shows strange latencies heading north â€“ but not to the North Pole, rather directly to a star belonging to the constellation of the Little Bear.<br><br><h4>Puzzle 17</h4>Which star is meant? Write down the first letter.    """,    18: """<h3>In the Land of Reindeer</h3>The team arrives in Levi, Finland. Reindeer tracks everywhere â€“ but no sign of Rudolph.<br><br><h4>Puzzle 18</h4>A Finnish sauna has a temperature of 120Â° and a â€¦ of 10%? Write down the second-to-last letter.    """,    19: """<h3>The Secret Cabin</h3>Melanie points to an odd weak curve. A faint Bluetooth signal, as Michael explains. â€œThatâ€™s Rudolphâ€™s emergency transmitter!â€ Susana shouts excitedly.<br><br><h4>Puzzle 19</h4>Which letter is the abbreviation for â€œSignal to Noise Ratioâ€? From the third word, take the fourth letter.    """,    20: """<h3>Rudolph Found!</h3>They find Rudolph â€“ playful but unharmed. He had been frolicking through the snow with local reindeer.<br><br><h4>Puzzle 20</h4>Whatâ€™s a common New Yearâ€™s greeting? Take the first letter of the third word.    """,    21: """<h3>But One Problemâ€¦</h3>Rudolphâ€™s horn transmitter is broken. The team repairs it with an improvised FWA antenna and secures a fixed IP so he can always be located.<br><br><h4>Puzzle 21</h4>What is the first letter of the first name of Jesus' mother?    """,    22: """<h3>Return Flight</h3>With the repaired transmitter, everyone flies back together on the sleigh. The Christmas mission is saved!<br><br><h4>Puzzle 22</h4>What is the name of the vertical axis in a chart? Write down the first letter.    """,    23: """<h3>Big Christmas Workshop</h3>Back home, Melanie thanks the team: â€œYou saved Christmas!â€ and â€¦<br><br><h4>Puzzle 23</h4>Which letter corresponds to this UTF-8 code: U+1D39?    """,    24: """<h3>Merry Christmas!</h3>â€œâ€¦ you have shown that together, there is a solution for everything. You are a fantastic team!â€<br><br><h4>What is the final solution phrase?</h4>The 24 letters form the solution phrase â€“ ignore the letter P.    """}# ========== DOORS LAYOUT ==========cols_per_row = 6for row in range(4):    cols = st.columns(cols_per_row)    for idx, col in enumerate(cols):        door = row * cols_per_row + idx + 1        if door > 24:            continue        with col:            is_open = door in st.session_state.open_doors            can_open = (door == current_day)            # Label (emoji only when closed)            if not is_open:                label = f"{emojis[door]}  Door {door}"            else:                label = f"Door {door}"            if not is_open and not can_open:                label += " (locked ğŸ”’)"            # Open door            if st.button(label, key=f"door{door}", disabled=not can_open and not is_open):                st.session_state.open_doors.add(door)                save_doors(st.session_state.open_doors)                is_open = True            # If open â†’ show compact content box (NO emoji)            if is_open:                st.markdown(f"<div class='open-box'>{door_content[door]}</div>", unsafe_allow_html=True)